# 法律智能问答系统 - 产品需求文档

## 1. 背景与目标

### 为什么要做
面向刑事案件领域，构建一个针对法律文书的 RAG 检索系统。

### 解决什么问题
- 律师/检察官在案件分析过程中，证据查找费时
- 容易遗漏关键信息

### 核心逻辑
针对不同类型的法律文书，提供定制化解析方案，实现精准检索。

### 成功标准
1. 问答准确率 > 95%
2. 每个回答必须标注来源，且能准确对应案件文书的具体位置（页码、段落等）

---

## 2. 目标用户

| 用户类型 | 场景 | 当前痛点 |
|---------|------|---------|
| 律师 | 案件研究 | 手动查阅证据、检索效率低、容易遗漏 |
| 检察官 | 证据核查 | 同上 |
| 律师团队 | 协作办案 | 同上 |

> **当前定位**：刑事案件领域（基于现有数据）
> **未来扩展**：有数据后可扩展到其他案件类型

---

## 3. 核心功能

### 3.1 案件文书解析

**描述**：上传案件文书 PDF，自动结构化解析

**输入**：PDF 文件

**输出**：结构化数据（含布局、内容、位置信息）

**支持文书类型**：
- 讯问/询问笔录
- 起诉意见书

**验收标准**：

**讯问/询问笔录**
- Given：上传一份讯问笔录 PDF
- When：系统完成解析
- Then：输出包含基础信息块（时间、地点、人员等）和问答对块，每个块标注页码和位置

**起诉意见书**
- Given：上传一份起诉意见书 PDF
- When：系统完成解析
- Then：输出包含以下字段：
  - 首部信息：标题、编号
  - 犯罪嫌疑人基本信息：姓名、性别、出生日期、民族、籍贯、文化程度、工作单位、职业、住址
  - 违法犯罪经历：是否受过刑事处罚、劳动教养、是否在押及羁押处所
  - 犯罪事实：时间、地点、动机、目的、手段、经过、结果
  - 认定证据：主要证据名称及内容
  - 触犯法条：涉嫌罪名、触犯的刑法条款
  - 附项信息：证物/赃物、证人信息、鉴定人信息

---

### 3.2 法律知识库构建

**描述**：将解析后的文档组织成可检索的知识库

**输入**：结构化文档数据

**输出**：向量化知识库

**验收标准**：

- Given：解析完成 10 份案件文书
- When：构建知识库
- Then：支持按文书类型筛选（讯问笔录/起诉意见书）

- Given：知识库中包含某份讯问笔录
- When：搜索"收款"
- Then：返回所有包含"收款"关键词的问答对，并标注来源文书和位置

---

### 3.3 智能问答

**描述**：基于知识库回答用户问题

**输入**：自然语言问题

**输出**：固定结构化答案

**输出结构**：
```
1. 结论
   - 直接回答问题的核心结论

2. 证据
   - 逐条引用：页码 + 具体位置 + 原文短摘录
   - 例：[P12-L5] "2023年6月15日，被告人收到人民币5万元"
   - 例：[P3-段落2] "讯问时间：2023年6月10日14时"

3. 推理说明
   - 只解释如何从证据得出结论
   - 不引入新事实，不编造内容

4. 材料缺口/不确定性
   - 找不到的信息明确说明"材料未显示"
   - 例："材料未显示：被告人银行流水记录"

5. RAG 检索原始数据
   - 附上检索到的所有相关片段（含来源）
```

**硬约束**：
1. **禁止无证据断言**：没有检索到证据就必须回答"材料未显示"，不得编造
2. **金额/日期必须直接引用**：凡涉及数值，必须在证据摘录中出现该数值，不得转述或推断
3. **精确定位**：引用必须标注"哪一页、哪一句"

**验收标准**：

- Given：知识库中已导入案件文书
- When：用户提问"被告人第一次供述中提到的收款金额是多少？"
- Then：按固定结构返回答案，证据部分包含页码+位置+原文摘录

- Given：知识库中未包含相关内容
- When：用户提问知识库之外的问题
- Then：在"材料缺口/不确定性"中回答"材料未显示"，结论为空

- Given：用户提问涉及金额或日期
- When：系统返回答案
- Then：证据摘录中必须包含原始数值，不得自行转述

- Given：用户提问涉及多个证据点
- When：系统检索到多条相关内容
- Then：证据部分逐条列出（页码+位置+原文），推理说明解释如何综合得出结论

---

## 4. 不做的事（MVP 阶段）

### 高级分析
| 功能 | 原因 |
|------|------|
| 时间线梳理 | 基于后续 RAG 扩展 |
| 证据链构建 | 基于后续 RAG 扩展 |
| 矛盾点检测 | 基于后续 RAG 扩展 |
| 辩护策略建议 | 基于后续 RAG 扩展 |

### 检索增强
| 功能 | 原因 |
|------|------|
| 类案检索 | 需要外部数据源 |
| 法条引用增强 | 非核心功能 |
| 裁判文书网对接 | 需要外部数据源 |

### 交互增强
| 功能 | 原因 |
|------|------|
| 多轮对话 | MVP 聚焦单轮问答 |

### 用户系统
| 功能 | 原因 |
|------|------|
| 账号/权限/付费 | 后续商业化考虑 |

### 其他
| 功能 | 原因 |
|------|------|
| 案件预测/胜诉率 | 风险高，非核心 |
| 多语言支持 | 先做好中文 |
| 导出报告 | 非核心流程 |
| 数据隐私方案 | 内部 MVP 暂不需要 |

---

## 5. 验收方式

### 评测方法
采用 **LLM 自动评测 + 人工复审** 的方式：

1. **LLM 评测**
   - 准备标准题库（问题 + 标准答案要点）
   - 调用 LLM 对 RAG 返回的答案进行评分
   - 评估维度：准确性、证据引用完整性、是否编造

2. **记录结果**
   - 自动记录每道题的评分和详细分析
   - 统计整体准确率

3. **人工复审**
   - 对评分较低或有争议的答案进行人工检查
   - 确认评测结果的可靠性

### MVP 完成标准
- 题库测评准确率 > 95%
- 人工抽检 20% 样本，确认评测结果可靠
