{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Legal RAG Benchmark Schema",
  "description": "Schema for benchmarking legal RAG systems on interrogation transcripts",
  "type": "object",
  "required": ["benchmark_name", "version", "document_info", "questions"],
  "properties": {
    "benchmark_name": {
      "type": "string",
      "description": "Name of the benchmark dataset"
    },
    "version": {
      "type": "string",
      "description": "Schema version (e.g., 1.0.0)"
    },
    "document_info": {
      "type": "object",
      "description": "Information about the source document(s)",
      "required": ["doc_id", "doc_type"],
      "properties": {
        "doc_id": {
          "type": "string",
          "description": "Document identifier (e.g., 'output')"
        },
        "doc_type": {
          "type": "string",
          "description": "Document type (e.g., 'interrogation_transcript')"
        },
        "source_path": {
          "type": "string",
          "description": "Path to the source document"
        },
        "total_pages": {
          "type": "integer",
          "description": "Total number of pages in the document"
        }
      }
    },
    "questions": {
      "type": "array",
      "description": "List of benchmark questions",
      "items": {
        "type": "object",
        "required": ["id", "type", "question", "expected", "required_evidence", "scoring"],
        "properties": {
          "id": {
            "type": "string",
            "description": "Unique identifier for the question (e.g., 'fact_001')"
          },
          "type": {
            "type": "string",
            "enum": ["fact_exact", "evidence_set", "conflict_gap"],
            "description": "Question type: fact_exact (single fact), evidence_set (multiple evidence pieces), conflict_gap (conflicts or gaps)"
          },
          "question": {
            "type": "string",
            "description": "The test question to be answered"
          },
          "expected": {
            "type": "object",
            "description": "Expected answer structure",
            "properties": {
              "amount_total": {
                "type": "number",
                "description": "Expected total amount for monetary questions"
              },
              "amount_breakdown": {
                "type": "array",
                "description": "Expected amount breakdown for complex questions",
                "items": {
                  "type": "object",
                  "properties": {
                    "amount": {"type": "number"},
                    "description": {"type": "string"}
                  }
                }
              },
              "date": {
                "type": "string",
                "description": "Expected date in ISO format (YYYY-MM-DD)"
              },
              "date_range": {
                "type": "object",
                "description": "Expected date range",
                "properties": {
                  "start": {"type": "string", "format": "date"},
                  "end": {"type": "string", "format": "date"}
                }
              },
              "count": {
                "type": "integer",
                "description": "Expected count (e.g., number of transactions)"
              },
              "text_answer": {
                "type": "string",
                "description": "Expected text answer for non-numeric questions"
              },
              "boolean_answer": {
                "type": "boolean",
                "description": "Expected boolean answer (e.g., guilty/not guilty)"
              },
              "entity": {
                "type": "string",
                "description": "Expected entity (person, location, organization)"
              },
              "evidence_count_min": {
                "type": "integer",
                "description": "Minimum number of evidence pieces required"
              },
              "should_abstain": {
                "type": "boolean",
                "description": "Whether the system should abstain from answering due to gaps/conflicts"
              },
              "conflict_detected": {
                "type": "boolean",
                "description": "Whether the system should detect a conflict"
              }
            }
          },
          "required_evidence": {
            "type": "array",
            "description": "List of required evidence pieces",
            "items": {
              "type": "object",
              "required": ["page", "must_include"],
              "properties": {
                "page": {
                  "type": "integer",
                  "description": "Page number where evidence is located"
                },
                "must_include": {
                  "type": "string",
                  "description": "Text that must be included in the evidence (e.g., '42000', '退款')"
                },
                "section": {
                  "type": "string",
                  "description": "Section type (e.g., 'qa_pair', 'header')"
                },
                "speaker": {
                  "type": "string",
                  "description": "Speaker (e.g., 'question', 'answer')"
                },
                "is_critical": {
                  "type": "boolean",
                  "description": "Whether this evidence is critical (missing it fails the question)"
                }
              }
            }
          },
          "scoring": {
            "type": "object",
            "description": "Scoring criteria for this question",
            "properties": {
              "numeric_exact": {
                "type": "boolean",
                "description": "Whether numeric answers require exact match"
              },
              "date_exact": {
                "type": "boolean",
                "description": "Whether dates require exact match"
              },
              "citation_required": {
                "type": "boolean",
                "description": "Whether citation of page numbers is required"
              },
              "evidence_recall_min": {
                "type": "number",
                "minimum": 0,
                "maximum": 1,
                "description": "Minimum evidence recall (0-1) to pass"
              },
              "evidence_precision_min": {
                "type": "number",
                "minimum": 0,
                "maximum": 1,
                "description": "Minimum evidence precision (0-1) to pass"
              },
              "abstention_required": {
                "type": "boolean",
                "description": "Whether abstention is required (for conflict_gap type)"
              },
              "hallucination_penalty": {
                "type": "number",
                "description": "Penalty for hallucination (0-1)"
              },
              "partial_credit": {
                "type": "boolean",
                "description": "Whether partial credit is allowed"
              },
              "weight": {
                "type": "number",
                "description": "Weight of this question in overall score (default: 1.0)"
              }
            }
          },
          "metadata": {
            "type": "object",
            "description": "Optional metadata",
            "properties": {
              "difficulty": {
                "type": "string",
                "enum": ["easy", "medium", "hard"],
                "description": "Difficulty level"
              },
              "category": {
                "type": "string",
                "description": "Question category (e.g., 'monetary', 'temporal', 'factual')"
              },
              "tags": {
                "type": "array",
                "items": {"type": "string"},
                "description": "Tags for grouping questions"
              },
              "notes": {
                "type": "string",
                "description": "Additional notes"
              }
            }
          }
        }
      }
    },
    "scoring_config": {
      "type": "object",
      "description": "Global scoring configuration",
      "properties": {
        "overall_pass_threshold": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Minimum overall score to pass the benchmark"
        },
        "type_weights": {
          "type": "object",
          "description": "Weights for each question type",
          "properties": {
            "fact_exact": {"type": "number"},
            "evidence_set": {"type": "number"},
            "conflict_gap": {"type": "number"}
          }
        }
      }
    }
  }
}
